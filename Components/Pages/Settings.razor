@page "/Settings"
@using Microsoft.Maui.Controls.PlatformConfiguration
@using TodoApp.Models.DataModels.Enums
@implements IDisposable;
<form>
    <div class="form-group row">
        <InputSelect class="form-control form-control-lg col-sm-10" id="lightingMode" @bind-Value="@localSettings.DefaultLighting">

            @foreach (var lightingState in Enum.GetValues(typeof(DefaultLighting)))
            {

                <option value="@lightingState">@lightingState</option>
            }
        </InputSelect>
    </div>
    <div class="form-group row" style="margin-top: 30px;">
        <button type="button" class="btn btn-primary" @onclick="ConfirmDeletionDatabase">
            Delete database
        </button>
    </div>
</form>
@code {
    SettingsRecord localSettings = SettingsHelper.GetSettingsRecord();

    void IDisposable.Dispose()
    {
        SettingsHelper.UpdateSettings(localSettings);
    }

    private void ConfirmDeletionDatabase()
    {
        var window = App.Current.Windows[0].Page;
        window.Dispatcher.Dispatch(async () =>
        {
            if (await window.DisplayAlert("Confirmation", "Are you sure you want to delete your database? You will not be able to recover this data and it will reset everything", "Accept", "Cancel"))
                DatabaseHelper.DeleteDatabase();
        });

    }

}
